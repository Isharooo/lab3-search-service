# Quarkus Application Configuration
quarkus.application.name=search-service

# HTTP Configuration
quarkus.http.port=8083

# --- CORS Configuration ---
# Tillåter din specifika frontend att anropa denna service
quarkus.http.cors=true
quarkus.http.cors.origins=${FRONTEND_URL:https://lab3-frontend1.app.cloud.cbh.kth.se},http://localhost:5173,http://localhost:3000
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.exposed-headers=Content-Disposition
quarkus.http.cors.access-control-allow-credentials=true

# --- Database Configuration (MariaDB) ---
# Quarkus använder MySQL-drivrutinen för MariaDB (reactive)
quarkus.datasource.db-kind=mysql
quarkus.datasource.username=${DB_USER:journal_user}
quarkus.datasource.password=${DB_PASSWORD:journal_pass123}

# Dynamisk URL som matchar dina Kubernetes-tjänster
quarkus.datasource.reactive.url=mysql://${DB_HOST:lab3-mariadb1}:${DB_PORT:3306}/${DB_NAME:patient_journal_db}

# Hibernate Reactive Configuration
quarkus.hibernate-orm.database.generation=update
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.sql-load-script=no-file

# --- Kafka Configuration ---
kafka.bootstrap.servers=${KAFKA_BOOTSTRAP_SERVERS:kafka-service:9092}

# Incoming Patient Events
mp.messaging.incoming.patient-events.connector=smallrye-kafka
mp.messaging.incoming.patient-events.topic=patient.events
mp.messaging.incoming.patient-events.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.incoming.patient-events.auto.offset.reset=earliest
mp.messaging.incoming.patient-events.enable.auto.commit=true
mp.messaging.incoming.patient-events.group.id=search-service-patient-group

# Incoming Journal Events
mp.messaging.incoming.journal-events.connector=smallrye-kafka
mp.messaging.incoming.journal-events.topic=journal.events
mp.messaging.incoming.journal-events.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.incoming.journal-events.auto.offset.reset=earliest
mp.messaging.incoming.journal-events.enable.auto.commit=true
mp.messaging.incoming.journal-events.group.id=search-service-journal-group

# Incoming Encounter Events
mp.messaging.incoming.encounter-events.connector=smallrye-kafka
mp.messaging.incoming.encounter-events.topic=encounter-events
mp.messaging.incoming.encounter-events.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.incoming.encounter-events.auto.offset.reset=earliest
mp.messaging.incoming.encounter-events.enable.auto.commit=true
mp.messaging.incoming.encounter-events.group.id=search-service

# Logging
quarkus.log.level=INFO
quarkus.log.category."se.kth.lab3".level=DEBUG